#!/bin/sh
# oxr 2025
# Captura la salida de una orden o lee de un archivo, y entrega cada linea a un
# script o comando, que se ejecuta con cada linea recibida.
#
# \\b    (orden |) tb (-a archivo) comando [argumentos]
#


tb(){
local l="$1" a="$2"
[ $# -gt 0 ] || { infsh ~/code/tb 3 6 ; return ;}
[ $l = -a ] && {
	shift 2
	[ $# -gt 0 ] || set -- echo -n
	while read l ; do # lee de archivo
		"$@" "$l"
		echo
	done < "$a"
	[ ! "$l" ] || "$@" "$l" # en algun caso es necesario
} || {
	while read l ; do # lee de tuberia
		"$@" "$l"
		echo
	done
	}
}


[ ${0##*/} != tb ] || tb "$@"
#
